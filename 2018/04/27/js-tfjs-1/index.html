<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 【tensorflow.js学习笔记（1）】tf.js环境搭建及曲线拟合例子 · Orangecsy's Blog</title><meta name="description" content="【tensorflow.js学习笔记（1）】tf.js环境搭建及曲线拟合例子 - orangecsy"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://orangecsy.github.io/atom.xml" title="Orangecsy's Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/orangecsy" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="https://blog.csdn.net/orangecsy" target="_blank" class="nav-list-link">CSDN</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">【tensorflow.js学习笔记（1）】tf.js环境搭建及曲线拟合例子</h1><div class="post-info">2018年4月27日</div><div class="post-content"><p>月初TensorFlow开发者大会上，谷歌正式发布了TensorFlow的JS版本tensorflow.js，并演示了几个很有意思的demo，展现了浏览器环境下也能进行深度学习任务的能力。tensorflowjs利用WebGl加速，在浏览器环境下训练、部署机器学习模型。下面我尝试引入tensorflow.js并运行一个曲线拟合的例子。  </p>
<h3 id="1、文件形式引入"><a href="#1、文件形式引入" class="headerlink" title="1、文件形式引入"></a>1、文件形式引入</h3><a id="more"></a>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">"https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@0.10.0"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span>  </span><br><span class="line">&lt;script&gt;  </span><br><span class="line">  <span class="keyword">const</span> model = tf.sequential();  </span><br><span class="line">  model.add(tf.layers.dense(&#123;<span class="attr">units</span>: <span class="number">1</span>, <span class="attr">inputShape</span>: [<span class="number">1</span>]&#125;));  </span><br><span class="line">  model.compile(&#123;<span class="attr">loss</span>: <span class="string">'meanSquaredError'</span>, <span class="attr">optimizer</span>: <span class="string">'sgd'</span>&#125;);  </span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> x = tf.tensor2d([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">4</span>, <span class="number">1</span>]);  </span><br><span class="line">  <span class="keyword">const</span> y = tf.tensor2d([<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>], [<span class="number">4</span>, <span class="number">1</span>]);  </span><br><span class="line">  </span><br><span class="line">  model.fit(x, y).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;  </span><br><span class="line">    model.predict(tf.tensor2d([<span class="number">5</span>], [<span class="number">1</span>, <span class="number">1</span>])).print();  </span><br><span class="line">  &#125;);  </span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<p>首先调用tf.sequential()构建模型，损失函数为均方差，优化器为sgd（梯度下降）。待拟合的点序列为(1,1),(2,3),(3,5),(4,7)，训练模型，输入x=5。<br>打开浏览器，输出为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Tensor  </span><br><span class="line">     [[<span class="number">8.1529675</span>],]</span><br></pre></td></tr></table></figure></p>
<h3 id="2、使用webpack"><a href="#2、使用webpack" class="headerlink" title="2、使用webpack"></a>2、使用webpack</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @tensorflow/tfjs</span><br></pre></td></tr></table></figure>
<p>首先利用npm安装tensorflow.js（也可用yarn），新建index.js文件，内容如下。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> tf <span class="keyword">from</span> <span class="string">'@tensorflow/tfjs'</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">const</span> model = tf.sequential();  </span><br><span class="line">model.add(tf.layers.dense(&#123;<span class="attr">units</span>: <span class="number">1</span>, <span class="attr">inputShape</span>: [<span class="number">1</span>]&#125;));  </span><br><span class="line">model.compile(&#123;<span class="attr">loss</span>: <span class="string">'meanSquaredError'</span>, <span class="attr">optimizer</span>: <span class="string">'sgd'</span>&#125;);  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">const</span> xs = tf.tensor2d([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">4</span>, <span class="number">1</span>]);  </span><br><span class="line"><span class="keyword">const</span> ys = tf.tensor2d([<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>], [<span class="number">4</span>, <span class="number">1</span>]);  </span><br><span class="line">  </span><br><span class="line">model.fit(xs, ys).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;  </span><br><span class="line">  model.predict(tf.tensor2d([<span class="number">5</span>], [<span class="number">1</span>, <span class="number">1</span>])).print();  </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>利用webpack可使用import语法引入tf.js。配置webpack.config.js文件如下。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">module</span>.exports=&#123;  </span><br><span class="line">    <span class="comment">//入口文件的配置项  </span></span><br><span class="line">    entry:&#123;  </span><br><span class="line">      entry: <span class="string">'./index.js'</span>  </span><br><span class="line">    &#125;,  </span><br><span class="line">    <span class="comment">//出口文件的配置项  </span></span><br><span class="line">    output:&#123;  </span><br><span class="line">      path: path.resolve(__dirname, <span class="string">'dist'</span>),  </span><br><span class="line">      filename: <span class="string">'bundle.js'</span>  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>运行webpack命令，将在目录下生成dist文件夹。cd进入该文件夹，用node运行bundle.js文件，输出结果。  </p>
<h3 id="3、曲线拟合"><a href="#3、曲线拟合" class="headerlink" title="3、曲线拟合"></a>3、曲线拟合</h3><p>（待续）  </p>
</div></article></div></main><footer><div class="paginator"><a href="/2018/04/25/js-2048/" class="next">NEXT</a></div><div class="copyright"><p>© 2018 <a href="https://orangecsy.github.io">orangecsy</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>